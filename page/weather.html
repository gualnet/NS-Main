<!doctype html>
<html lang="en" class="h-100">


{{element->header_app.html}}

<body class="body-scroll d-flex flex-column h-100 menu-overlay">
    <!-- screen loader -->
    {{element->loader.html}}

    <!-- Begin page content -->
    <main class="flex-shrink-0">
        <!-- Fixed navbar -->
        {{element->navheader.html}}
        <!-- page content start -->
        <!-- map -->
        <div class="container py-3">
            <div class="row" style="display: block;margin:auto;margin-top:25vh;" id="weather">
                <!--  <iframe style="display: block; width: 100%; height: 90%; border: none;" src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d1674.9494684683343!2d-1.458484208354475!3d53.580323542286514!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sin!4v1598610506292!5m2!1sen!2sin" class="map-view-map" frameborder="0" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>-->

            </div>
            {{element->navbar.html}}
        </div>
    </main>

    <!-- Required jquery and libraries -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- cookie js -->
    <script src="js/jquery.cookie.js"></script>

    <!-- Swiper slider  js-->
    <script src="vendor/swiper/js/swiper.min.js"></script>

    <!-- Masonry js -->
    <script src="vendor/masonry/masonry.pkgd.min.js"></script>

    <!-- nouislider js -->
    <script src="vendor/nouislider/nouislider.min.js"></script>

    <!-- Customized jquery file  -->
    <script src="js/main.js"></script>
    <script src="js/color-scheme-demo.js"></script>

    <!-- page level custom script -->
    <script>
        "use strict"
        $(window).on('load', async function () {
            initSwiper();
            const weatherForecastLink = await getWeatherForecastLink();
            displayWeatherButton(weatherForecastLink);
        });
        
        const initSwiper = () => {
            /* carousel */
            var swiper = new Swiper('.swiper-products', {
                slidesPerView: 'auto',
                spaceBetween: 0,
                pagination: 'false'
            });
        };

        const specialRules = () => {
            const ST_RAPH_ID = 'VgZpWU_BEY';
            const currentEntityId = localStorage['entity_id'];
            if (currentEntityId === ST_RAPH_ID) {
                return 'https://meteo-varoise.fr/santalucia/meteo-straphael.pdf';
            }
            return;
        };

        const getWeatherForecastLink = async () => {
            try {
                let link = specialRules();
                if (link) return link;

                const url = `/api/weather/forecasts/${localStorage["harbour_id"]}`;
                const response = await fetch(url, { method: 'GET' });
                const respJson = await response.json();
                return respJson.data.img;
            } catch (error) {
                console.error('[ERROR]', error);
            }
        };

        const displayWeatherButton = async (link) => {
            if (!link) {
                document.getElementById("weather").innerHTML = '<p class="text-secondary text-justify" style="padding-top:100px;">Aucun bulletin météo publié pour ce port.</p>';
            } else {
                document.getElementById("weather").innerHTML = '<a class="btn btn-primary" style="font-size:12px;width:100%" target="_blank" href="' + link + '">Ouvrir le bulletin météo</a>';
            }
        }
    </script>
    {{element->footer_app.html}}
</body>
<!-- Mirrored from maxartkiller.com/website/Nauticspot/nearby.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 31 Aug 2020 16:49:14 GMT -->
</html>
